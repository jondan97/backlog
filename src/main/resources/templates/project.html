<!DOCTYPE html>
<html lang="en" xmlns:sec="http://www.w3.org/1999/xhtml" xmlns:th="http://www.w3.org/1999/xhtml">
<head>
    <meta charset="UTF-8">
    <title>Project Page</title>
</head>
<body>
<button th:onclick="'window.location.href=\'' + @{/} + '\''"
        type="button">Home
</button>
<button
        th:onclick="'window.location.href=\'' + @{'/user/projectPanel'} + '\''"
        type="button">Project Panel
</button>
<button
        th:onclick="'window.location.href=\'' + @{'/user/project/' + ${project.id} + '/projectProgress'} + '\''"
        type="button">Project Progress
</button>

<h3>Active Sprint:</h3>
<span th:insert="include/sprint :: sprintForm"></span>
<h4>Items in Sprint:</h4>
<span th:if="${sprint}" th:style="'border-style: solid;display:block;'">
    <div th:each="itemSprintHistory : ${sprint.associatedItems}">
            <span th:with="item =${itemSprintHistory.item}">
                <span th:if="${item.status == 2 or item.status == 3}">
                    <span th:insert="include/setOfItems :: items"></span>
                </span>
            </span>
    </div>
</span>
<h3>Backlog:</h3>
<div th:each="item : ${backlog}">
    <span th:if="${item.status == 1}">
        <span th:insert="include/setOfItems :: items" th:style="'border-style: solid;display:block;'"></span>
    </span>
</div>
<!--create a new item-->
<span sec:authorize="hasAnyAuthority('PROJECT_MANAGER', 'ADMIN')">
    <h3>Create New Item</h3>
    <span th:insert="include/createItem :: createForm"></span>

</span>
<script>
    function toggleInputs() {
        const x = document.getElementById("type").value;
        if (x === "BUG" || x === "TASK") {
            document.getElementById("fakeEffort").disabled = false;
            document.getElementById("fakeParentId").disabled = false;
            const x = document.getElementById("fakeParentId");
            document.getElementById("disabledParentInput").remove();

        } else if (x === "STORY") {
            document.getElementById("fakeEffort").disabled = true;
            document.getElementById("fakeParentId").disabled = false;
            const x = document.getElementById("fakeParentId");
            document.getElementById("disabledParentInput").remove();
        } else if (x === "EPIC") {
            document.getElementById("fakeEffort").disabled = true;
            const x = document.getElementById("fakeParentId");
            const option = document.createElement("option");
            option.text = "Disabled";
            option.id = "disabledParentInput";
            option.setAttribute('selected', 'selected');
            x.add(option);
            document.getElementById("fakeParentId").disabled = true;
        }
    }

    function checkInputs() {
        const x = document.getElementById("type").value;
        if (x === "BUG" || x === "TASK") {
            document.getElementById("effort").value = document.getElementById("fakeEffort").value;
            document.getElementById("parentId").value = document.getElementById("fakeParentId").value;
        }
    }
</script>
</body>
</html>